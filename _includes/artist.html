<!-- Composition grid -->
{%- assign items = "" | split: "" -%}

{%- assign category      = page.category -%}
{%- assign category_slug = category | slugify -%}
{%- assign artist      = page.title -%}
{%- assign artist_slug = artist | slugify -%}
{%- assign songs       = site.data.compositions[category][artist] -%}
{%- for s in songs -%}
  {%- assign song = s[0] -%}
  {%- assign song_slug = song | slugify -%}
  {%- assign meta = s[1] -%}
  {%- assign file_url = category_slug | append: '/' | append: artist_slug | append: '/' | append: song_slug -%}
  {%- assign pdf_url  = '/assets/compositions/' | append: file_url | append: '.pdf' -%}
  {%- assign mscz_url = '/assets/compositions/' | append: file_url | append: '.mscz' -%}
  {%- assign img_url  = '/assets/compositions/' | append: file_url | append: '.jpg' -%}
  {%- assign page_url = '/' | append: file_url | append: '/' -%}
  {%- assign row = meta.date | append: '||' | 
           append: category  | append: '||' | 
           append: artist    | append: '||' | 
           append: song      | append: '||' | 
           append: pdf_url   | append: '||' |
           append: mscz_url  | append: '||' |
           append: img_url   | append: '||' |
           append: page_url -%}
  {%- assign items = items | push: row -%}
{%- endfor -%}

{%- assign items = items | sort | reverse -%}

<div class="w3-row-padding w3-grayscale">
  {%- for row in items -%}
    {%- assign parts    = row | split:'||' -%}
    {%- assign date     = parts[0] -%}
    {%- assign category = parts[1] -%}
    {%- assign artist   = parts[2] -%}
    {%- assign song     = parts[3] -%}
    {%- assign pdf_url  = parts[4] -%}
    {%- assign mscz_url = parts[5] -%}
    {%- assign img_url  = parts[6] -%}
    {%- assign page_url = parts[7] -%}
    <div class="w3-col l3 s6" style="margin-bottom:16px;">
      <a href="{{ page_url }}" class="w3-card w3-white w3-hover-shadow" style="display:block; text-decoration:none;">
        <div class="thumb-box">
          <img src="{{ img_url }}" alt="{{ artist }} â€” {{ song }}">
        </div>
        <div class="w3-container">
          <p class="w3-small w3-text-grey truncate">{{ artist }}</p>
          <p class="w3-medium truncate"><b>{{ song }}</b></p>
        </div>
      </a>
    </div>
  {%- endfor -%}
</div>